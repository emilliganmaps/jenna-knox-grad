<!DOCTYPE html>
<html>
    
<head>
    <meta charset="utf-8" />
    <title>Jenna's Graduation Map</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    
    <script src="https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.css" rel="stylesheet" />
    
    <style>
        
        body{
            margin: 0;
            padding: 0; 
        }
        
        #map{
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%; 
        }
        
    </style>
    
</head>
    
<body>
    
<div id="map"></div>
    
<script>
	mapboxgl.accessToken = 'pk.eyJ1IjoiZW1pbGxpZ2FuIiwiYSI6ImNrYTQzYXgzcjA0dmczZm5pMjliMWl0OW4ifQ.hZaHkI6bWwH9PE9655sw8A';
    var map = new mapboxgl.Map({
        container: 'map',   //container id
        style: 'mapbox://styles/emilligan/cka2jq4wy4rg81inw8ui81j2u',   //stylesheet location
        center: [-97.8, 39.828],    //starting position [lng, lat]
        zoom: 3.5,  //starting zoom

    });
    
    //disable map rotation using right click + drag
    map.dragRotate.disable();

    //disable map rotation using touch rotation gesture
    map.touchZoomRotate.disableRotation();
    
    map.on('load', function() {
        map.loadImage(
            'images/knoxgrad.png',
            function(error, image) {
                if (error) throw error;
                map.addImage('knox', image);
                map.addSource('point', {
                    'type': 'geojson',
                    'data': {
                        'type': 'FeatureCollection',
                        'features': [
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Mom and Dad</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Mom and Dad!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-92.480, 44.0121]
                                    }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Grandma Ida</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Grandma Ida!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-96.405, 42.496]
                                    }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Grandma Bonnie & Grandpa Ted</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Grandma & Grandpa Ziegler!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-88.083, 42.033]
                                    }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Ellie & Josh M.</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Ellie & Josh!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-92.9952, 44.9530]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Aaron</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Aaron!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-92.526, 43.99]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Annie P.</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Annie!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-91.530, 41.661]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Dylan Z.</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see a message from Dylan!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-89.094, 42.271]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Amy, Mike, J, & K</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see their message!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-96.158, 41.365]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Troy, Lisa, M&M&M </strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see their message!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-96.321, 42.434]
                                }
                            },
                            {
                                'type': 'Feature',
                                'properties': {
                                    'description':
                                        '<strong>From Amy, Wayne, C, & R</strong><p><a href="https://www.knox.edu/commencement-information" target="_blank" title="Opens in a new window">Click to see their message!</a></p>',
                                    'icon': 'knox'
                                },
                                'geometry': {
                                    'type': 'Point',
                                    'coordinates': [-94.798, 29.301]
                                }
                            }
                        ]
                    }
                });
                map.addLayer({
                    'id': 'points',
                    'type': 'symbol',
                    'source': 'point',
                    'layout': {
                        'icon-image': 'knox',
                        'icon-size': 0.25,
                        'icon-allow-overlap': true
                    }
                });
                
                //when a click event occurs on a feature in the places layer, open a popup at the location of the feature, with description HTML from its properties.
                map.on('click', 'points', function(e) {
                    var coordinates = e.features[0].geometry.coordinates.slice();
                    var description = e.features[0].properties.description;

                    //ensure that if the map is zoomed out such that multiple copies of the feature are visible, the popup appears over the copy being pointed to.
                    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                    coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                    }

                    new mapboxgl.Popup()
                    .setLngLat(coordinates)
                    .setHTML(description)
                    .addTo(map);
                });

                //change the cursor to a pointer when the mouse is over the places layer.
                map.on('mouseenter', 'places', function() {
                    map.getCanvas().style.cursor = 'pointer';
                });

                //change back to pointer
                map.on('mouseleave', 'places', function() {
                    map.getCanvas().style.cursor = '';
                });
            }
        );
    });
</script>

</body>
</html>